{"ast":null,"code":"import { resolver, SecurePassword } from \"blitz\";\nimport db from \"db\";\nimport { Signup } from \"app/auth/validations\";\nexport default resolver.pipe(resolver.zod(Signup), async ({\n  email,\n  password\n}, ctx) => {\n  const hashedPassword = await SecurePassword.hash(password);\n  const user = await db.user.create({\n    data: {\n      email: email.toLowerCase(),\n      hashedPassword,\n      role: \"USER\"\n    },\n    select: {\n      id: true,\n      name: true,\n      email: true,\n      role: true\n    }\n  });\n  await ctx.session.$create({\n    userId: user.id,\n    role: user.role\n  });\n  return user;\n});","map":null,"metadata":{},"sourceType":"module"}